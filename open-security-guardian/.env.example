# Open Security Guardian Environment Configuration
# Copy this file to .env and update with your settings

# =============================================================================
# DJANGO SETTINGS
# =============================================================================

# Django secret key (generate a new one for production)
SECRET_KEY=your-secret-key-here-make-it-long-and-random-at-least-50-characters

# Debug mode (set to False in production)
DEBUG=False

# Allowed hosts (comma-separated)
ALLOWED_HOSTS=localhost,127.0.0.1,guardian.local,*.guardian.local

# Timezone
TIME_ZONE=UTC

# Language code
LANGUAGE_CODE=en-us

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# Database URL format: postgresql://user:password@host:port/dbname
DATABASE_URL=postgresql://guardian:CHANGE_ME@localhost:5432/guardian

# Alternative format for advanced configurations
DB_ENGINE=django.db.backends.postgresql
DB_NAME=guardian
DB_USER=guardian
DB_PASSWORD=CHANGE_ME
DB_HOST=localhost
DB_PORT=5432

# Database connection pool settings
DB_CONN_MAX_AGE=60
DB_CONN_HEALTH_CHECKS=True

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================

# Redis URL for caching and Celery
REDIS_URL=redis://localhost:6379/0

# Celery broker URL (usually same as Redis URL)
CELERY_BROKER_URL=redis://localhost:6379/0

# Celery result backend
CELERY_RESULT_BACKEND=redis://localhost:6379/0

# Cache configuration
CACHE_TTL=300
CACHE_KEY_PREFIX=guardian

# =============================================================================
# CELERY CONFIGURATION
# =============================================================================

# Celery worker settings
CELERY_WORKER_CONCURRENCY=4
CELERY_TASK_SOFT_TIME_LIMIT=300
CELERY_TASK_TIME_LIMIT=600

# Celery beat settings
CELERY_BEAT_SCHEDULE_ENABLED=True

# =============================================================================
# EMAIL CONFIGURATION
# =============================================================================

# Email backend
EMAIL_BACKEND=django.core.mail.backends.smtp.EmailBackend

# SMTP settings
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_USE_TLS=True
EMAIL_HOST_USER=your-email@example.com
EMAIL_HOST_PASSWORD=your-email-password

# From email
DEFAULT_FROM_EMAIL=guardian@example.com
SERVER_EMAIL=guardian@example.com

# Notification settings
DEFAULT_NOTIFICATION_RECIPIENTS=admin@example.com,security@example.com

# =============================================================================
# SECURITY SETTINGS
# =============================================================================

# API key for external integrations
GUARDIAN_API_KEY=your-api-key-here

# JWT settings
JWT_SECRET_KEY=your-jwt-secret-key
JWT_EXPIRATION_HOURS=24

# Rate limiting
RATE_LIMIT_ENABLED=True
RATE_LIMIT_PER_HOUR=1000

# CORS settings
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://127.0.0.1:3000
CORS_ALLOW_CREDENTIALS=True

# CSRF settings
CSRF_TRUSTED_ORIGINS=http://localhost:3000,http://127.0.0.1:3000

# Session settings
SESSION_COOKIE_SECURE=False
CSRF_COOKIE_SECURE=False
SESSION_COOKIE_AGE=86400

# =============================================================================
# WILDBOX SUITE INTEGRATION
# =============================================================================
WILDBOX_API_URL=http://localhost:8000
WILDBOX_API_KEY=wildbox-security-api-key-2025
WILDBOX_DATA_URL=http://localhost:8001
WILDBOX_DATA_API_KEY=your-data-api-key-here

# =============================================================================
# VULNERABILITY SCANNER INTEGRATIONS
# =============================================================================

# Nessus Scanner
NESSUS_ENABLED=false
NESSUS_URL=https://nessus.example.com:8834
NESSUS_USERNAME=admin
NESSUS_PASSWORD=nessus_password
NESSUS_VERIFY_SSL=true

# Qualys Scanner
QUALYS_ENABLED=false
QUALYS_URL=https://qualysapi.qualys.com
QUALYS_USERNAME=api_user
QUALYS_PASSWORD=qualys_password

# OpenVAS Scanner
OPENVAS_ENABLED=false
OPENVAS_URL=https://openvas.example.com:9392
OPENVAS_USERNAME=admin
OPENVAS_PASSWORD=openvas_password

# Rapid7 InsightVM
RAPID7_ENABLED=false
RAPID7_URL=https://us.api.insight.rapid7.com
RAPID7_API_KEY=your-rapid7-api-key

# =============================================================================
# TICKETING SYSTEM INTEGRATIONS
# =============================================================================

# JIRA Integration
JIRA_ENABLED=false
JIRA_URL=https://company.atlassian.net
JIRA_USERNAME=security@company.com
JIRA_API_TOKEN=your-jira-api-token
JIRA_PROJECT_KEY=SEC

# ServiceNow Integration
SERVICENOW_ENABLED=false
SERVICENOW_URL=https://company.service-now.com
SERVICENOW_USERNAME=security_api
SERVICENOW_PASSWORD=servicenow_password

# =============================================================================
# MONITORING & OBSERVABILITY
# =============================================================================

# Sentry Error Tracking
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
SENTRY_ENVIRONMENT=development

# Prometheus Metrics
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9090

# Logging Configuration
LOG_LEVEL=INFO
LOG_FORMAT=json
LOG_FILE=/var/log/guardian/guardian.log

# =============================================================================
# CELERY CONFIGURATION (Background Tasks)
# =============================================================================
CELERY_BROKER_URL=redis://localhost:6379/1
CELERY_RESULT_BACKEND=redis://localhost:6379/1
CELERY_TIMEZONE=UTC
CELERY_BEAT_SCHEDULE_FILENAME=/tmp/celerybeat-schedule

# =============================================================================
# NOTIFICATION SETTINGS
# =============================================================================

# Email Configuration
EMAIL_BACKEND=django.core.mail.backends.smtp.EmailBackend
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_USE_TLS=true
EMAIL_HOST_USER=guardian@company.com
EMAIL_HOST_PASSWORD=your-email-password
DEFAULT_FROM_EMAIL=Open Security Guardian <guardian@company.com>

# Slack Integration
SLACK_ENABLED=false
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK
SLACK_CHANNEL=#security-alerts

# Microsoft Teams Integration
TEAMS_ENABLED=false
TEAMS_WEBHOOK_URL=https://outlook.office.com/webhook/YOUR/TEAMS/WEBHOOK

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================

# API Security
API_RATE_LIMIT=1000/hour
API_THROTTLE_BURST=100
API_KEY_HEADER=X-API-Key

# Session Security
SESSION_COOKIE_SECURE=false
SESSION_COOKIE_HTTPONLY=true
SESSION_COOKIE_SAMESITE=Lax
CSRF_COOKIE_SECURE=false

# =============================================================================
# COMPLIANCE FRAMEWORKS
# =============================================================================
DEFAULT_COMPLIANCE_FRAMEWORKS=PCI_DSS,SOX,HIPAA,ISO27001,NIST_CSF

# =============================================================================
# RISK CALCULATION SETTINGS
# =============================================================================
RISK_CALCULATION_METHOD=advanced
THREAT_INTEL_WEIGHT=0.3
ASSET_CRITICALITY_WEIGHT=0.4
CVSS_WEIGHT=0.3
EXPLOITABILITY_WEIGHT=0.2

# =============================================================================
# ASSET DISCOVERY SETTINGS
# =============================================================================
ASSET_DISCOVERY_ENABLED=true
ASSET_DISCOVERY_SCHEDULE=0 2 * * *  # Daily at 2 AM
NETWORK_DISCOVERY_RANGES=10.0.0.0/8,172.16.0.0/12,192.168.0.0/16

# Cloud Provider APIs
AWS_ENABLED=false
AWS_ACCESS_KEY_ID=your-aws-access-key
AWS_SECRET_ACCESS_KEY=your-aws-secret-key
AWS_REGIONS=us-east-1,us-west-2,eu-west-1

AZURE_ENABLED=false
AZURE_CLIENT_ID=your-azure-client-id
AZURE_CLIENT_SECRET=your-azure-client-secret
AZURE_TENANT_ID=your-azure-tenant-id

GCP_ENABLED=false
GCP_PROJECT_ID=your-gcp-project-id
GCP_SERVICE_ACCOUNT_KEY_PATH=/path/to/service-account-key.json

# =============================================================================
# PERFORMANCE TUNING
# =============================================================================
MAX_CONCURRENT_SCANS=5
SCAN_TIMEOUT_SECONDS=3600
BULK_OPERATIONS_BATCH_SIZE=1000
DATABASE_CONN_MAX_AGE=300
CACHE_TIMEOUT_SECONDS=3600

# =============================================================================
# BACKUP CONFIGURATION
# =============================================================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 3 * * *  # Daily at 3 AM
BACKUP_RETENTION_DAYS=30
BACKUP_STORAGE_PATH=/var/backups/guardian
BACKUP_ENCRYPTION_KEY=your-backup-encryption-key
